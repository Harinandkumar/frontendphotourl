<!DOCTYPE html>
<html>
<head>
  <title>Admin Image Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<h2>Admin Login</h2>
<input id="token" placeholder="Enter Admin Token">
<button onclick="saveToken()">Save Token</button>

<hr>

<h2>Upload Image</h2>
<input type="file" id="photo">
<button onclick="upload()">Upload</button>

<div id="result"></div>

<hr>

<h2>Delete Image</h2>
<input id="filename" placeholder="Enter exact filename">
<button onclick="deleteImage()">Delete</button>

<div id="deleteStatus"></div>

<script>
const BACKEND = "https://photourlgeneratorbackend.onrender.com";

function saveToken(){
  localStorage.setItem("ADMIN_TOKEN", document.getElementById("token").value);
  alert("Saved!");
}

async function upload(){
  const token = localStorage.getItem("ADMIN_TOKEN");
  if(!token) return alert("Login first!");

  const file = document.getElementById("photo").files[0];
  if(!file) return alert("Select a file");

  const form = new FormData();
  form.append("photo", file);

  const res = await fetch(BACKEND + "/upload", {
    method:"POST",
    headers:{ "Authorization":"Bearer " + token },
    body:form
  });

  const data = await res.json();

  document.getElementById("result").innerHTML =
    "<p><b>Image URL:</b></p>" +
    `<a target=_blank href="${data.url}">${data.url}</a><br>` +
    "<p><b>Filename:</b> "+data.filename+"</p>" +
    `<img width=250 src="${data.url}">`;
}

async function deleteImage(){
  const token = localStorage.getItem("ADMIN_TOKEN");
  if(!token) return alert("Login first!");

  const filename = document.getElementById("filename").value;
  if(!filename) return alert("Enter filename");

  const res = await fetch(BACKEND + "/delete/" + filename, {
    method:"DELETE",
    headers:{ "Authorization":"Bearer " + token }
  });

  const data = await res.json();
  document.getElementById("deleteStatus").innerHTML = JSON.stringify(data);
}
</script>

</body>
</html>
